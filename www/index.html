<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <script src="shared/jquery.js" type="text/javascript"></script>
        <script src="shared/shiny.js" type="text/javascript"></script>
        <script src="https://kit.fontawesome.com/40b31feda3.js" crossorigin="anonymous">
        </script>
            <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

        <link rel="stylesheet" type="text/css" href="shared/shiny.css"/>
        <title>Document</title>
        <style type="text/css" media="all">
            * {
                box-sizing: border-box;
                
            }
            body {
                display: flex;
                height: 100vh;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: #FFFFFF;
background-image: linear-gradient(137deg, #FFFFFF 0%, #80a7bf 1%, #e9eff2 95%, #ffffff 100%);


                
            }
            
            .current_date {
              font-size: 30px;
              margin-bottom: 30px;
              color: white;
            }
            #PriceChart1, #PriceChart2 {
                width: 1200px;
                height: 650px;
                border: solid 3px white;
                border-radius: 3px;
            }
            #PriceChart1 {
              color: grey;
            }
            #PriceChart1 > img, #PriceChart2 > img {
              width: 100%;
              height: 100%;
            }
            #new_charts {
                color: #F24E29;
                width: 150px;
                height: 40px;
                font-size: 20px;
                border: none;
                border-radius: 3px;
                margin-top: 50px;
                outline: none;
            }
            
             #new_charts:hover {
               cursor: pointer;
             }
            .ba-slider {
                position: relative;
                overflow: hidden;
            }
             
                .ba-slider div {
                    width: 100%;
                    display:block;
                }
                 
                .resize {
                    position: absolute;
                    top:0;
                    left: 0;
                    height: 100%;
                    width: 50%;
                    overflow: hidden;
                }
                
                
                .handle { /* Thin line seperator */
                  position:absolute; 
                  left:50%;
                  top:0;
                  bottom:0;
                  width:1px;
                  margin-left:-2px;
                  background: #123E59;
                  cursor: ew-resize;
                }
                
                .draggable:after {
                    width: 48px;
                    height: 48px;
                    margin: -24px 0 0 -24px;
                    line-height:48px;
                    font-size:30px;
                }
                
                @media all and (max-width: 1300px) {
                  #PriceChart1, #PriceChart2 {
                      width: 1100px;
                      height: 597px;
                  }
                }
                @media all and (max-width: 1100px) {
                  #PriceChart1, #PriceChart2 {
                      width: 1000px;
                      height: 543px;
                  }
                }
                @media all and (max-width: 1000px) {
                  #PriceChart1, #PriceChart2 {
                      width: 850px;
                      height: 461px;
                  }
                }
                @media all and (max-width: 850px) {
                  #PriceChart1, #PriceChart2 {
                      width: 800px;
                      height: 434px;
                  }
                }
                @media all and (max-width: 800px) {
                  #PriceChart1, #PriceChart2 {
                      width: 750px;
                      height: 407px;
                  }
                }
                @media all and (max-width: 800px) {
                  #PriceChart1, #PriceChart2 {
                      width: 750px;
                      height: 407px;
                  }
                }
                @media all and (max-width: 800px) {
                  #PriceChart1, #PriceChart2 {
                      width: 750px;
                      height: 407px;
                  }
                }
                @media all and (max-width: 750px) {
                  #PriceChart1, #PriceChart2 {
                      width: 675px;
                      height: 366px;
                  }
                }
                @media all and (max-width: 675px) {
                  #PriceChart1, #PriceChart2 {
                      width: 500px;
                      height: 271px;
                  }
                }
                @media all and (max-width: 675px) {
                  #PriceChart1, #PriceChart2 {
                      width: 500px;
                      height: 271px;
                  }
                }
                @media all and (max-width: 500px) {
                  #PriceChart1, #PriceChart2 {
                      width: 450px;
                      height: 244px;
                  }
                }
                @media all and (max-width: 450px) {
                  #PriceChart1, #PriceChart2 {
                      width: 375px;
                      height: 203px;
                  }
                }
                @media all and (max-width: 375px) {
                  #PriceChart1, #PriceChart2 {
                      width: 350px;
                      height: 190px;
                  }
                }
                @media all and (max-width: 350px) {
                  #PriceChart1, #PriceChart2 {
                      width: 330px;
                      height: 179px;
                  }
                }
                
        </style>
    </head>
    <body>
        <script type="text/javascript" charset="utf-8">
            function getNewCharts() {
              var num1 = Math.round(Math.random() * 8 + 2011);
              var num2 = Math.round(Math.random() * 8 + 2011);
              var num3 = Math.round(Math.random() * 8 + 2011);
              var symbolIdx = Math.round(Math.random() * 58 + 1);
              var numbers = [];
              if(num1 == num2) {
                numbers.push(`${num1}-01-01`, `${num3}-01-01`, symbolIdx)
              } else {
                numbers.push(`${num1}-01-01`, `${num2}-01-01`, symbolIdx)
              
              }
              console.log(num1, num2, num3);
              Shiny.onInputChange("mydata", numbers);
            };
            
            $(document).ready(function(){
              $(".current_date").text(moment().format("dddd, MMMM Do YYYY"));
              $('.ba-slider').each(function(){
                var cur = $(this);
                // Adjust the slider
                var width = cur.width()+'px';
                cur.find('.resize img').css('width', width);
                // Bind dragging events
                drags(cur.find('.handle'), cur.find('.resize'), cur);
              });
            });

// Update sliders on resize. 
// Because we all do this: i.imgur.com/YkbaV.gif
$(window).resize(function(){
  $('.ba-slider').each(function(){
    var cur = $(this);
    var width = cur.width()+'px';
    cur.find('.resize #PriceChart1').css('width', width);
  });
});

function drags(dragElement, resizeElement, container) {
	
  // Initialize the dragging event on mousedown.
  dragElement.on('mousedown touchstart', function(e) {
    
    dragElement.addClass('draggable');
    resizeElement.addClass('resizable');
    
    // Check if it's a mouse or touch event and pass along the correct value
    var startX = (e.pageX) ? e.pageX : e.originalEvent.touches[0].pageX;
    
    // Get the initial position
    var dragWidth = dragElement.outerWidth(),
        posX = dragElement.offset().left + dragWidth - startX,
        containerOffset = container.offset().left,
        containerWidth = container.outerWidth();
 
    // Set limits
    minLeft = containerOffset + 10;
    maxLeft = containerOffset + containerWidth - dragWidth - 10;
    
    // Calculate the dragging distance on mousemove.
    dragElement.parents().on("mousemove touchmove", function(e) {
    	
      // Check if it's a mouse or touch event and pass along the correct value
      var moveX = (e.pageX) ? e.pageX : e.originalEvent.touches[0].pageX;
      
      leftValue = moveX + posX - dragWidth;
      
      // Prevent going off limits
      if ( leftValue < minLeft) {
        leftValue = minLeft;
      } else if (leftValue > maxLeft) {
        leftValue = maxLeft;
      }
      
      // Translate the handle's left value to masked divs width.
      widthValue = (leftValue + dragWidth/2 - containerOffset)*100/containerWidth+'%';
			
      // Set the new values for the slider and the handle. 
      // Bind mouseup events to stop dragging.
      $('.draggable').css('left', widthValue).on('mouseup touchend touchcancel', function () {
        $(this).removeClass('draggable');
        resizeElement.removeClass('resizable');
      });
      $('.resizable').css('width', widthValue);
    }).on('mouseup touchend touchcancel', function(){
      dragElement.removeClass('draggable');
      resizeElement.removeClass('resizable');
    });
    e.preventDefault();
  }).on('mouseup touchend touchcancel', function(e){
    dragElement.removeClass('draggable');
    resizeElement.removeClass('resizable');
  });
}
        </script>
        <h1>orinakin</h1>
        <div class="current_date"></div>
        <div class="ba-slider">
            <div 
                id="PriceChart2" 
                class="shiny-plot-output" 
            >
            </div>
            <div class="resize">
                <div 
                    id="PriceChart1" 
                    class="shiny-plot-output"
                >
                </div>
            </div>
            <span class="handle"></span>

        </div>
        <button 
            id="new_charts" 
            type="submit" 
            onclick="getNewCharts()"
        >
            <i class="fas fa-random"></i>
        </button>
    </body>
</html>
